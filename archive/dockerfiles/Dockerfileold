#Deriving the latest base image
FROM nvidia/cuda:11.2.1-cudnn8-devel-ubuntu18.04


#RUN apt-key del 7fa2af80
#RUN curl https://developer.download.nvidia.com/compute/cuda/repos/$distro/$arch/cuda-keyring_1.0-1_all.deb
#RUN dpkg -i cuda-keyring_1.0-1_all.deb

WORKDIR /

COPY ../.. ./
# Now the structure looks like this '/usr/app/src/test.py'
#
RUN apt-get update
RUN apt-get install python3.7 python3-pip -y

RUN pip3 install --no-cache --upgrade pip setuptools
RUN pip3 install -r requirements.txt
RUN pipreqs --force

#CMD instruction should be used to run the software
#contained by your image, along with any arguments.

CMD [ "python3", "./tests/test.py"]
CMD [ "python3", "./tests/collect_env.py"]